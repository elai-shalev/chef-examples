# Redis Sentinel configuration file
# Generated by Ansible

port {{ item.port }}
dir {{ redis_data_dir | default('/var/lib/redis') }}
daemonize yes
pidfile /var/run/redis/sentinel-{{ item.port }}.pid

sentinel monitor {{ item.master_name }} {{ item.master_ip }} {{ item.master_port }} {{ item.quorum }}
sentinel down-after-milliseconds {{ item.master_name }} {{ item.down_after_milliseconds | default(30000) }}
sentinel parallel-syncs {{ item.master_name }} {{ item.parallel_syncs | default(1) }}
sentinel failover-timeout {{ item.master_name }} {{ item.failover_timeout | default(180000) }}

{% if item.auth_pass is defined %}
sentinel auth-pass {{ item.master_name }} {{ item.auth_pass }}
{% endif %}

{% if item.notification_script is defined %}
sentinel notification-script {{ item.master_name }} {{ item.notification_script }}
{% endif %}

{% if item.client_reconfig_script is defined %}
sentinel client-reconfig-script {{ item.master_name }} {{ item.client_reconfig_script }}
{% endif %}

# Custom configuration
{% if item.custom_config is defined %}
{% for config in item.custom_config %}
{{ config }}
{% endfor %}
{% endif %}